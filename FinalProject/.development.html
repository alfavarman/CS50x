<!-- FOR DEVELOPMENT PURPOUSES ONLY -->
i blocked_list.csv (url,cagegory)
2 icon versions ON= block OFF=unblock // blue full size circle icon gray fullsize circle icon
switch = on if extension.off else off
left.click switch
if on, block nofitication + access (any method from/to any domain in list)
if off do nothing

right.click icon:
dropdown menu:
 switch off if swith.on else on
 block lists """ oppens list management page: allowes to eddit block lists (create new block list, add/remove url)"""
 timer %i """shows positive int i minutes blocade is on since switch on, if i = 0 blockade must be swithc off by user"""
 settings """ opens settings page in new tab"""
 about (display in new tab or popup custom text_about)

steps:

Create the manifest file: Create a manifest.json file in your extension's root directory. In this file, define the basic information about your extension, such as its name, version, permissions, and background scripts.

Create the user interface: Create the HTML, CSS, and JavaScript files for your extension's user interface. You can create a popup.html file that displays a switch to turn the extension on or off, and a timer to show how long the blockade is on since switch on. You can also create a list.html file that displays the block list and allows users to add or remove URLs.

Write the JavaScript code: In your JavaScript code, define an event listener for the switch in popup.html. When the switch is turned on, you can use the chrome.webRequest API to block access to URLs that match the URLs in your block list. When the switch is turned off, you can remove the block.

Store the block list: Store the block list in a CSV file or in the chrome.storage API. You can create a "block_list.csv" file that contains the URLs and their categories.

Add a timer: Use the setTimeout() function to set a timer for the blockade. When the timer expires, you can remove the block.

Add a right-click menu: Use the chrome.contextMenus API to create a right-click menu that allows users to switch the extension on or off, manage the block list, and access the settings page.

Test and publish: Test your extension by loading it as an unpacked extension in Chrome, and make any necessary adjustments. Once you're satisfied with your extension, publish it to the Chrome Web Store.

To install your extension in Chrome, users can follow these steps:

Go to the Chrome Web Store.

Search for your extension by name or keyword.

Click on the extension's listing.

Click on the "Add to Chrome" button.

Follow the prompts to install the extension.






import webListener from './web-listener.js';
import { updateExtensionState, toggleSwitch } from './state.js';
import { createContextMenus } from './context-menu.js';

// listen for action
let isOn = true;
chrome.browserAction.onClicked.addListener(function (tab) {
  // differ clicked button on extensiton icone
  // left click (0ledt 1middle 2right)
  if (tab.button === 0) {
    // Toggle the state of the extension
    isOn = !isOn;
    updateExtensionState(isOn);
  }
});

// listen webRequest: to edit or cancell them
chrome.webRequest.onBeforeRequest.addListener(
  webListener,
  { urls: ['<all_urls>'] },
  ['blocking']
);

// load cvs file
fetch(chrome.runtime.getURL('block_list.csv'))
  .then((response) => response.text())
  .then((text) => {
    console.log('CSV file loaded successfully');
    // phrase is to array blockList
    const blockList = [];
    const rows = text.split('\n');

    // read all rows
    for (let i = 0; i < rows.length; i++) {
      const [url, category] = rows[i].split(',');
      blockList.push({ url, category });
    }

    // store it
    chrome.storage.local.set({ blockList }, () => {
      console.log('Block list stored in local storage');
    });
  })
  .catch((error) => {
    console.log('Error loading CSV file:', error);
  });


// context menu
const contextMenuItems = [
  { 
    id: 'switch',
    title: 'Switch',
    onclick: toggleSwitch
  },
  { 
    id: 'blockList',
    title: 'Block Lists',
    onclick: openPage.bind(null, 'block_list.html')
  },
  { 
    id: 'timer',
    title: 'Timer',
    onclick: showTimer
  },
  { 
    id: 'settings',
    title: 'Settings',
    onclick: openPage.bind(null, 'settings.html')
  },
  { 
    id: 'about',
    title: 'About',
    onclick: showMessage.bind(null, 'This is Final Project of CS50X')
  }
];

createContextMenus(contextMenuItems);

// Define the onclick handlers for the context menu items

function openBlockListPage() {
  chrome.tabs.create({ url: chrome.extension.getURL('block_list.html') });
}

function showTimer() {
  chrome.storage.sync.get('timer', function(data) {
    const minutes = data.timer || 0;
    alert(`Blockade is on for ${minutes} minutes.`);
  });
}

function openSettingsPage() {
  chrome.tabs.create({ url: chrome.extension.getURL('settings.html') });
}

function openAboutPage() {
  alert('This is the about page.');
}
